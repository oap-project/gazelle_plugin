-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 48


-- !query
create table char_tbl(c char(5), v varchar(6)) using parquet
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_tbl            	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl


-- !query
desc formatted char_tbl c
-- !query schema
struct<info_name:string,info_value:string>
-- !query output
col_name	c
data_type	char(5)
comment	NULL
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query
show create table char_tbl
-- !query schema
struct<createtab_stmt:string>
-- !query output
CREATE TABLE `default`.`char_tbl` (
  `c` CHAR(5),
  `v` VARCHAR(6))
USING parquet


-- !query
create table char_tbl2 using parquet as select * from char_tbl
-- !query schema
struct<>
-- !query output



-- !query
show create table char_tbl2
-- !query schema
struct<createtab_stmt:string>
-- !query output
CREATE TABLE `default`.`char_tbl2` (
  `c` CHAR(5),
  `v` VARCHAR(6))
USING parquet


-- !query
desc formatted char_tbl2
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_tbl2           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl2


-- !query
desc formatted char_tbl2 c
-- !query schema
struct<info_name:string,info_value:string>
-- !query output
col_name	c
data_type	char(5)
comment	NULL
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query
create table char_tbl3 like char_tbl
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl3
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_tbl3           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl3


-- !query
desc formatted char_tbl3 c
-- !query schema
struct<info_name:string,info_value:string>
-- !query output
col_name	c
data_type	char(5)
comment	NULL
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query
show create table char_tbl3
-- !query schema
struct<createtab_stmt:string>
-- !query output
CREATE TABLE `default`.`char_tbl3` (
  `c` CHAR(5),
  `v` VARCHAR(6))
USING parquet


-- !query
create view char_view as select * from char_tbl
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_view
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_view           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	select * from char_tbl	                    
View Original Text  	select * from char_tbl	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c, v]              	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=default, view.query.out.col.0=c, view.query.out.col.1=v, view.query.out.numCols=2, view.referredTempFunctionsNames=[], view.referredTempViewNames=[]]


-- !query
desc formatted char_view c
-- !query schema
struct<info_name:string,info_value:string>
-- !query output
col_name	c
data_type	char(5)
comment	NULL
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query
show create table char_view
-- !query schema
struct<createtab_stmt:string>
-- !query output
CREATE VIEW `default`.`char_view` (
  `c`,
  `v`)
AS select * from char_tbl


-- !query
alter table char_tbl rename to char_tbl1
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl1
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_tbl1           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl1


-- !query
alter table char_tbl1 change column c type char(6)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
ALTER TABLE CHANGE COLUMN is not supported for changing column 'c' with type 'CharType(5)' to 'c' with type 'CharType(6)'


-- !query
alter table char_tbl1 change column c type char(5)
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl1
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_tbl1           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl1


-- !query
alter table char_tbl1 add columns (d char(5))
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl1
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
d                   	char(5)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_tbl1           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl1


-- !query
alter view char_view as select * from char_tbl2
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_view
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_view           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	select * from char_tbl2	                    
View Original Text  	select * from char_tbl2	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c, v]              	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=default, view.query.out.col.0=c, view.query.out.col.1=v, view.query.out.numCols=2, view.referredTempFunctionsNames=[], view.referredTempViewNames=[]]


-- !query
alter table char_tbl1 SET TBLPROPERTIES('yes'='no')
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl1
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
d                   	char(5)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_tbl1           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Table Properties    	[yes=no]            	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl1


-- !query
alter view char_view SET TBLPROPERTIES('yes'='no')
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_view
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_view           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	select * from char_tbl2	                    
View Original Text  	select * from char_tbl2	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c, v]              	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=default, view.query.out.col.0=c, view.query.out.col.1=v, view.query.out.numCols=2, view.referredTempFunctionsNames=[], view.referredTempViewNames=[], yes=no]


-- !query
alter table char_tbl1 UNSET TBLPROPERTIES('yes')
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl1
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
d                   	char(5)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_tbl1           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl1


-- !query
alter view char_view UNSET TBLPROPERTIES('yes')
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_view
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_view           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	select * from char_tbl2	                    
View Original Text  	select * from char_tbl2	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[c, v]              	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=default, view.query.out.col.0=c, view.query.out.col.1=v, view.query.out.numCols=2, view.referredTempFunctionsNames=[], view.referredTempViewNames=[]]


-- !query
alter table char_tbl1 SET SERDEPROPERTIES('yes'='no')
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_tbl1
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c                   	char(5)             	                    
v                   	varchar(6)          	                    
d                   	char(5)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_tbl1           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_tbl1	                    
Storage Properties  	[yes=no]


-- !query
create table char_part(c1 char(5), c2 char(2), v1 varchar(6), v2 varchar(2)) using parquet partitioned by (v2, c2)
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_part
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	char(5)             	                    
v1                  	varchar(6)          	                    
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_part           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_part	                    
Partition Provider  	Catalog


-- !query
alter table char_part add partition (v2='ke', c2='nt') location 'loc1'
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_part
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	char(5)             	                    
v1                  	varchar(6)          	                    
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_part           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_part	                    
Partition Provider  	Catalog


-- !query
alter table char_part partition (v2='ke') rename to partition (v2='nt')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Partition spec is invalid. The spec (v2) must match the partition spec (v2, c2) defined in table '`default`.`char_part`'


-- !query
desc formatted char_part
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	char(5)             	                    
v1                  	varchar(6)          	                    
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_part           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_part	                    
Partition Provider  	Catalog


-- !query
alter table char_part partition (v2='ke', c2='nt') set location 'loc2'
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_part
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	char(5)             	                    
v1                  	varchar(6)          	                    
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_part           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_part	                    
Partition Provider  	Catalog


-- !query
MSCK REPAIR TABLE char_part
-- !query schema
struct<>
-- !query output



-- !query
desc formatted char_part
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
c1                  	char(5)             	                    
v1                  	varchar(6)          	                    
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
v2                  	varchar(2)          	                    
c2                  	char(2)             	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	char_part           	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Location [not included in comparison]/{warehouse_dir}/char_part	                    
Partition Provider  	Catalog


-- !query
drop table char_tbl1
-- !query schema
struct<>
-- !query output



-- !query
drop table char_tbl2
-- !query schema
struct<>
-- !query output



-- !query
drop table char_tbl3
-- !query schema
struct<>
-- !query output

