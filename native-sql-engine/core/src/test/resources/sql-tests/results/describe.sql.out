-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 41


-- !query
CREATE TABLE t (a STRING, b INT, c STRING, d STRING) USING parquet
  OPTIONS (a '1', b '2')
  PARTITIONED BY (c, d) CLUSTERED BY (a) SORTED BY (b ASC) INTO 2 BUCKETS
  COMMENT 'table_comment'
  TBLPROPERTIES (t 'test')
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW temp_v AS SELECT * FROM t
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW temp_Data_Source_View
  USING org.apache.spark.sql.sources.DDLScanSource
  OPTIONS (
    From '1',
    To '10',
    Table 'test1')
-- !query schema
struct<>
-- !query output



-- !query
CREATE VIEW v AS SELECT * FROM t
-- !query schema
struct<>
-- !query output



-- !query
ALTER TABLE t SET TBLPROPERTIES (e = '3')
-- !query schema
struct<>
-- !query output



-- !query
ALTER TABLE t ADD PARTITION (c='Us', d=1)
-- !query schema
struct<>
-- !query output



-- !query
DESCRIBE t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query
DESC default.t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query
DESC TABLE t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query
DESC FORMATTED t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Comment             	table_comment       	                    
Table Properties    	[e=3, t=test]       	                    
Location [not included in comparison]/{warehouse_dir}/t	                    
Storage Properties  	[a=1, b=2]          	                    
Partition Provider  	Catalog


-- !query
DESC EXTENDED t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Comment             	table_comment       	                    
Table Properties    	[e=3, t=test]       	                    
Location [not included in comparison]/{warehouse_dir}/t	                    
Storage Properties  	[a=1, b=2]          	                    
Partition Provider  	Catalog


-- !query
ALTER TABLE t UNSET TBLPROPERTIES (e)
-- !query schema
struct<>
-- !query output



-- !query
DESC EXTENDED t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Comment             	table_comment       	                    
Table Properties    	[t=test]            	                    
Location [not included in comparison]/{warehouse_dir}/t	                    
Storage Properties  	[a=1, b=2]          	                    
Partition Provider  	Catalog


-- !query
ALTER TABLE t UNSET TBLPROPERTIES (comment)
-- !query schema
struct<>
-- !query output



-- !query
DESC EXTENDED t
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	MANAGED             	                    
Provider            	parquet             	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Table Properties    	[t=test]            	                    
Location [not included in comparison]/{warehouse_dir}/t	                    
Storage Properties  	[a=1, b=2]          	                    
Partition Provider  	Catalog


-- !query
DESC t PARTITION (c='Us', d=1)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string


-- !query
DESC EXTENDED t PARTITION (c='Us', d=1)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[c=Us, d=1]         	                    
Location [not included in comparison]/{warehouse_dir}/t/c=Us/d=1	                    
Storage Properties  	[a=1, b=2]          	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
                    	                    	                    
# Storage Information	                    	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Location [not included in comparison]/{warehouse_dir}/t	                    
Storage Properties  	[a=1, b=2]


-- !query
DESC FORMATTED t PARTITION (c='Us', d=1)
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
# Partition Information	                    	                    
# col_name          	data_type           	comment             
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Partition Information	                    	                    
Database            	default             	                    
Table               	t                   	                    
Partition Values    	[c=Us, d=1]         	                    
Location [not included in comparison]/{warehouse_dir}/t/c=Us/d=1	                    
Storage Properties  	[a=1, b=2]          	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
                    	                    	                    
# Storage Information	                    	                    
Num Buckets         	2                   	                    
Bucket Columns      	[`a`]               	                    
Sort Columns        	[`b`]               	                    
Location [not included in comparison]/{warehouse_dir}/t	                    
Storage Properties  	[a=1, b=2]


-- !query
DESC t PARTITION (c='Us', d=2)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchPartitionException
Partition not found in table 't' database 'default':
c -> Us
d -> 2


-- !query
DESC t PARTITION (c='Us')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Partition spec is invalid. The spec (c) must match the partition spec (c, d) defined in table '`default`.`t`'


-- !query
DESC t PARTITION (c='Us', d)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException

PARTITION specification is incomplete: `d`(line 1, pos 0)

== SQL ==
DESC t PARTITION (c='Us', d)
^^^


-- !query
DESC temp_v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query
DESC TABLE temp_v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query
DESC FORMATTED temp_v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query
DESC EXTENDED temp_v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query
DESC temp_Data_Source_View
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
intType             	int                 	test comment test1  
stringType          	string              	                    
dateType            	date                	                    
timestampType       	timestamp           	                    
doubleType          	double              	                    
bigintType          	bigint              	                    
tinyintType         	tinyint             	                    
decimalType         	decimal(10,0)       	                    
fixedDecimalType    	decimal(5,1)        	                    
binaryType          	binary              	                    
booleanType         	boolean             	                    
smallIntType        	smallint            	                    
floatType           	float               	                    
mapType             	map<string,string>  	                    
arrayType           	array<string>       	                    
structType          	struct<f1:string,f2:int>


-- !query
DESC temp_v PARTITION (c='Us', d=1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
DESC PARTITION is not allowed on a temporary view: temp_v


-- !query
DESC v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query
DESC TABLE v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string


-- !query
DESC FORMATTED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[a, b, c, d]        	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=default, view.query.out.col.0=a, view.query.out.col.1=b, view.query.out.col.2=c, view.query.out.col.3=d, view.query.out.numCols=4, view.referredTempFunctionsNames=[], view.referredTempViewNames=[]]


-- !query
DESC EXTENDED v
-- !query schema
struct<col_name:string,data_type:string,comment:string>
-- !query output
a                   	string              	                    
b                   	int                 	                    
c                   	string              	                    
d                   	string              	                    
                    	                    	                    
# Detailed Table Information	                    	                    
Database            	default             	                    
Table               	v                   	                    
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type                	VIEW                	                    
View Text           	SELECT * FROM t     	                    
View Original Text  	SELECT * FROM t     	                    
View Catalog and Namespace	spark_catalog.default	                    
View Query Output Columns	[a, b, c, d]        	                    
Table Properties    	[view.catalogAndNamespace.numParts=2, view.catalogAndNamespace.part.0=spark_catalog, view.catalogAndNamespace.part.1=default, view.query.out.col.0=a, view.query.out.col.1=b, view.query.out.col.2=c, view.query.out.col.3=d, view.query.out.numCols=4, view.referredTempFunctionsNames=[], view.referredTempViewNames=[]]


-- !query
DESC v PARTITION (c='Us', d=1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
DESC PARTITION is not allowed on a view: v


-- !query
EXPLAIN DESC t
-- !query schema
struct<plan:string>
-- !query output
== Physical Plan ==
Execute DescribeTableCommand
   +- DescribeTableCommand `default`.`t`, false


-- !query
EXPLAIN DESC EXTENDED t
-- !query schema
struct<plan:string>
-- !query output
== Physical Plan ==
Execute DescribeTableCommand
   +- DescribeTableCommand `default`.`t`, true


-- !query
EXPLAIN EXTENDED DESC t
-- !query schema
struct<plan:string>
-- !query output
== Parsed Logical Plan ==
'DescribeRelation false
+- 'UnresolvedTableOrView [t], DESCRIBE TABLE, true

== Analyzed Logical Plan ==
col_name: string, data_type: string, comment: string
DescribeTableCommand `default`.`t`, false

== Optimized Logical Plan ==
DescribeTableCommand `default`.`t`, false

== Physical Plan ==
Execute DescribeTableCommand
   +- DescribeTableCommand `default`.`t`, false


-- !query
EXPLAIN DESCRIBE t b
-- !query schema
struct<plan:string>
-- !query output
== Physical Plan ==
Execute DescribeColumnCommand
   +- DescribeColumnCommand `default`.`t`, [b], false


-- !query
EXPLAIN DESCRIBE t PARTITION (c='Us', d=2)
-- !query schema
struct<plan:string>
-- !query output
== Physical Plan ==
Execute DescribeTableCommand
   +- DescribeTableCommand `default`.`t`, Map(c -> Us, d -> 2), false


-- !query
DROP TABLE t
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW temp_v
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW temp_Data_Source_View
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW v
-- !query schema
struct<>
-- !query output

