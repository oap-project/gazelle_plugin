-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 100


-- !query
CREATE TEMPORARY VIEW t AS select '2011-05-06 07:08:09.1234567' as c, interval 10 year 20 month 30 day 40 hour 50 minute 6.7890 second as i
-- !query schema
struct<>
-- !query output



-- !query
select extract(year from c), extract(year from i) from t
-- !query schema
struct<extract(year FROM c):int,extract(year FROM i):int>
-- !query output
2011	11


-- !query
select extract(y from c), extract(y from i) from t
-- !query schema
struct<extract(y FROM c):int,extract(y FROM i):int>
-- !query output
2011	11


-- !query
select extract(years from c), extract(years from i) from t
-- !query schema
struct<extract(years FROM c):int,extract(years FROM i):int>
-- !query output
2011	11


-- !query
select extract(yr from c), extract(yr from i) from t
-- !query schema
struct<extract(yr FROM c):int,extract(yr FROM i):int>
-- !query output
2011	11


-- !query
select extract(yrs from c), extract(yrs from i) from t
-- !query schema
struct<extract(yrs FROM c):int,extract(yrs FROM i):int>
-- !query output
2011	11


-- !query
select extract(yearofweek from c) from t
-- !query schema
struct<extract(yearofweek FROM c):int>
-- !query output
2011


-- !query
select extract(quarter from c) from t
-- !query schema
struct<extract(quarter FROM c):int>
-- !query output
2


-- !query
select extract(qtr from c) from t
-- !query schema
struct<extract(qtr FROM c):int>
-- !query output
2


-- !query
select extract(month from c), extract(month from i) from t
-- !query schema
struct<extract(month FROM c):int,extract(month FROM i):tinyint>
-- !query output
5	8


-- !query
select extract(mon from c), extract(mon from i) from t
-- !query schema
struct<extract(mon FROM c):int,extract(mon FROM i):tinyint>
-- !query output
5	8


-- !query
select extract(mons from c), extract(mons from i) from t
-- !query schema
struct<extract(mons FROM c):int,extract(mons FROM i):tinyint>
-- !query output
5	8


-- !query
select extract(months from c), extract(months from i) from t
-- !query schema
struct<extract(months FROM c):int,extract(months FROM i):tinyint>
-- !query output
5	8


-- !query
select extract(week from c) from t
-- !query schema
struct<extract(week FROM c):int>
-- !query output
18


-- !query
select extract(w from c) from t
-- !query schema
struct<extract(w FROM c):int>
-- !query output
18


-- !query
select extract(weeks from c) from t
-- !query schema
struct<extract(weeks FROM c):int>
-- !query output
18


-- !query
select extract(day from c), extract(day from i) from t
-- !query schema
struct<extract(day FROM c):int,extract(day FROM i):int>
-- !query output
6	31


-- !query
select extract(d from c), extract(d from i) from t
-- !query schema
struct<extract(d FROM c):int,extract(d FROM i):int>
-- !query output
6	31


-- !query
select extract(days from c), extract(days from i) from t
-- !query schema
struct<extract(days FROM c):int,extract(days FROM i):int>
-- !query output
6	31


-- !query
select extract(dayofweek from c) from t
-- !query schema
struct<extract(dayofweek FROM c):int>
-- !query output
6


-- !query
select extract(dow from c) from t
-- !query schema
struct<extract(dow FROM c):int>
-- !query output
6


-- !query
select extract(dayofweek_iso from c) from t
-- !query schema
struct<extract(dayofweek_iso FROM c):int>
-- !query output
5


-- !query
select extract(dow_iso from c) from t
-- !query schema
struct<extract(dow_iso FROM c):int>
-- !query output
5


-- !query
select extract(doy from c) from t
-- !query schema
struct<extract(doy FROM c):int>
-- !query output
126


-- !query
select extract(hour from c), extract(hour from i) from t
-- !query schema
struct<extract(hour FROM c):int,extract(hour FROM i):bigint>
-- !query output
7	16


-- !query
select extract(h from c), extract(h from i) from t
-- !query schema
struct<extract(h FROM c):int,extract(h FROM i):bigint>
-- !query output
7	16


-- !query
select extract(hours from c), extract(hours from i) from t
-- !query schema
struct<extract(hours FROM c):int,extract(hours FROM i):bigint>
-- !query output
7	16


-- !query
select extract(hr from c), extract(hr from i) from t
-- !query schema
struct<extract(hr FROM c):int,extract(hr FROM i):bigint>
-- !query output
7	16


-- !query
select extract(hrs from c), extract(hrs from i) from t
-- !query schema
struct<extract(hrs FROM c):int,extract(hrs FROM i):bigint>
-- !query output
7	16


-- !query
select extract(minute from c), extract(minute from i) from t
-- !query schema
struct<extract(minute FROM c):int,extract(minute FROM i):tinyint>
-- !query output
8	50


-- !query
select extract(m from c), extract(m from i) from t
-- !query schema
struct<extract(m FROM c):int,extract(m FROM i):tinyint>
-- !query output
8	50


-- !query
select extract(min from c), extract(min from i) from t
-- !query schema
struct<extract(min FROM c):int,extract(min FROM i):tinyint>
-- !query output
8	50


-- !query
select extract(mins from c), extract(mins from i) from t
-- !query schema
struct<extract(mins FROM c):int,extract(mins FROM i):tinyint>
-- !query output
8	50


-- !query
select extract(minutes from c), extract(minutes from i) from t
-- !query schema
struct<extract(minutes FROM c):int,extract(minutes FROM i):tinyint>
-- !query output
8	50


-- !query
select extract(second from c), extract(second from i) from t
-- !query schema
struct<extract(second FROM c):decimal(8,6),extract(second FROM i):decimal(8,6)>
-- !query output
9.123456	6.789000


-- !query
select extract(s from c), extract(s from i) from t
-- !query schema
struct<extract(s FROM c):decimal(8,6),extract(s FROM i):decimal(8,6)>
-- !query output
9.123456	6.789000


-- !query
select extract(sec from c), extract(sec from i) from t
-- !query schema
struct<extract(sec FROM c):decimal(8,6),extract(sec FROM i):decimal(8,6)>
-- !query output
9.123456	6.789000


-- !query
select extract(seconds from c), extract(seconds from i) from t
-- !query schema
struct<extract(seconds FROM c):decimal(8,6),extract(seconds FROM i):decimal(8,6)>
-- !query output
9.123456	6.789000


-- !query
select extract(secs from c), extract(secs from i) from t
-- !query schema
struct<extract(secs FROM c):decimal(8,6),extract(secs FROM i):decimal(8,6)>
-- !query output
9.123456	6.789000


-- !query
select extract(not_supported from c) from t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Literals of type 'not_supported' are currently not supported for the string type.; line 1 pos 7


-- !query
select extract(not_supported from i) from t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Literals of type 'not_supported' are currently not supported for the interval type.; line 1 pos 7


-- !query
select date_part('year', c), date_part('year', i) from t
-- !query schema
struct<date_part(year, c):int,date_part(year, i):int>
-- !query output
2011	11


-- !query
select date_part('y', c), date_part('y', i) from t
-- !query schema
struct<date_part(y, c):int,date_part(y, i):int>
-- !query output
2011	11


-- !query
select date_part('years', c), date_part('years', i) from t
-- !query schema
struct<date_part(years, c):int,date_part(years, i):int>
-- !query output
2011	11


-- !query
select date_part('yr', c), date_part('yr', i) from t
-- !query schema
struct<date_part(yr, c):int,date_part(yr, i):int>
-- !query output
2011	11


-- !query
select date_part('yrs', c), date_part('yrs', i) from t
-- !query schema
struct<date_part(yrs, c):int,date_part(yrs, i):int>
-- !query output
2011	11


-- !query
select date_part('yearofweek', c) from t
-- !query schema
struct<date_part(yearofweek, c):int>
-- !query output
2011


-- !query
select date_part('quarter', c) from t
-- !query schema
struct<date_part(quarter, c):int>
-- !query output
2


-- !query
select date_part('qtr', c) from t
-- !query schema
struct<date_part(qtr, c):int>
-- !query output
2


-- !query
select date_part('month', c), date_part('month', i) from t
-- !query schema
struct<date_part(month, c):int,date_part(month, i):tinyint>
-- !query output
5	8


-- !query
select date_part('mon', c), date_part('mon', i) from t
-- !query schema
struct<date_part(mon, c):int,date_part(mon, i):tinyint>
-- !query output
5	8


-- !query
select date_part('mons', c), date_part('mons', i) from t
-- !query schema
struct<date_part(mons, c):int,date_part(mons, i):tinyint>
-- !query output
5	8


-- !query
select date_part('months', c), date_part('months', i) from t
-- !query schema
struct<date_part(months, c):int,date_part(months, i):tinyint>
-- !query output
5	8


-- !query
select date_part('week', c) from t
-- !query schema
struct<date_part(week, c):int>
-- !query output
18


-- !query
select date_part('w', c) from t
-- !query schema
struct<date_part(w, c):int>
-- !query output
18


-- !query
select date_part('weeks', c) from t
-- !query schema
struct<date_part(weeks, c):int>
-- !query output
18


-- !query
select date_part('day', c), date_part('day', i) from t
-- !query schema
struct<date_part(day, c):int,date_part(day, i):int>
-- !query output
6	31


-- !query
select date_part('d', c), date_part('d', i) from t
-- !query schema
struct<date_part(d, c):int,date_part(d, i):int>
-- !query output
6	31


-- !query
select date_part('days', c), date_part('days', i) from t
-- !query schema
struct<date_part(days, c):int,date_part(days, i):int>
-- !query output
6	31


-- !query
select date_part('dayofweek', c) from t
-- !query schema
struct<date_part(dayofweek, c):int>
-- !query output
6


-- !query
select date_part('dow', c) from t
-- !query schema
struct<date_part(dow, c):int>
-- !query output
6


-- !query
select date_part('dayofweek_iso', c) from t
-- !query schema
struct<date_part(dayofweek_iso, c):int>
-- !query output
5


-- !query
select date_part('dow_iso', c) from t
-- !query schema
struct<date_part(dow_iso, c):int>
-- !query output
5


-- !query
select date_part('doy', c) from t
-- !query schema
struct<date_part(doy, c):int>
-- !query output
126


-- !query
select date_part('hour', c), date_part('hour', i) from t
-- !query schema
struct<date_part(hour, c):int,date_part(hour, i):bigint>
-- !query output
7	16


-- !query
select date_part('h', c), date_part('h', i) from t
-- !query schema
struct<date_part(h, c):int,date_part(h, i):bigint>
-- !query output
7	16


-- !query
select date_part('hours', c), date_part('hours', i) from t
-- !query schema
struct<date_part(hours, c):int,date_part(hours, i):bigint>
-- !query output
7	16


-- !query
select date_part('hr', c), date_part('hr', i) from t
-- !query schema
struct<date_part(hr, c):int,date_part(hr, i):bigint>
-- !query output
7	16


-- !query
select date_part('hrs', c), date_part('hrs', i) from t
-- !query schema
struct<date_part(hrs, c):int,date_part(hrs, i):bigint>
-- !query output
7	16


-- !query
select date_part('minute', c), date_part('minute', i) from t
-- !query schema
struct<date_part(minute, c):int,date_part(minute, i):tinyint>
-- !query output
8	50


-- !query
select date_part('m', c), date_part('m', i) from t
-- !query schema
struct<date_part(m, c):int,date_part(m, i):tinyint>
-- !query output
8	50


-- !query
select date_part('min', c), date_part('min', i) from t
-- !query schema
struct<date_part(min, c):int,date_part(min, i):tinyint>
-- !query output
8	50


-- !query
select date_part('mins', c), date_part('mins', i) from t
-- !query schema
struct<date_part(mins, c):int,date_part(mins, i):tinyint>
-- !query output
8	50


-- !query
select date_part('minutes', c), date_part('minutes', i) from t
-- !query schema
struct<date_part(minutes, c):int,date_part(minutes, i):tinyint>
-- !query output
8	50


-- !query
select date_part('second', c), date_part('second', i) from t
-- !query schema
struct<date_part(second, c):decimal(8,6),date_part(second, i):decimal(8,6)>
-- !query output
9.123456	6.789000


-- !query
select date_part('s', c), date_part('s', i) from t
-- !query schema
struct<date_part(s, c):decimal(8,6),date_part(s, i):decimal(8,6)>
-- !query output
9.123456	6.789000


-- !query
select date_part('sec', c), date_part('sec', i) from t
-- !query schema
struct<date_part(sec, c):decimal(8,6),date_part(sec, i):decimal(8,6)>
-- !query output
9.123456	6.789000


-- !query
select date_part('seconds', c), date_part('seconds', i) from t
-- !query schema
struct<date_part(seconds, c):decimal(8,6),date_part(seconds, i):decimal(8,6)>
-- !query output
9.123456	6.789000


-- !query
select date_part('secs', c), date_part('secs', i) from t
-- !query schema
struct<date_part(secs, c):decimal(8,6),date_part(secs, i):decimal(8,6)>
-- !query output
9.123456	6.789000


-- !query
select date_part('not_supported', c) from t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Literals of type 'not_supported' are currently not supported for the string type.; line 1 pos 7


-- !query
select date_part(c, c) from t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
The field parameter needs to be a foldable string value.; line 1 pos 7


-- !query
select date_part(null, c) from t
-- !query schema
struct<date_part(NULL, c):double>
-- !query output
NULL


-- !query
select date_part(i, i) from t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
The field parameter needs to be a foldable string value.; line 1 pos 7


-- !query
select date_part(null, i) from t
-- !query schema
struct<date_part(NULL, i):double>
-- !query output
NULL


-- !query
select extract('year', c) from t
-- !query schema
struct<extract(year FROM c):int>
-- !query output
2011


-- !query
select extract('quarter', c) from t
-- !query schema
struct<extract(quarter FROM c):int>
-- !query output
2


-- !query
select extract('month', c) from t
-- !query schema
struct<extract(month FROM c):int>
-- !query output
5


-- !query
select extract('week', c) from t
-- !query schema
struct<extract(week FROM c):int>
-- !query output
18


-- !query
select extract('day', c) from t
-- !query schema
struct<extract(day FROM c):int>
-- !query output
6


-- !query
select extract('days', c) from t
-- !query schema
struct<extract(days FROM c):int>
-- !query output
6


-- !query
select extract('dayofweek', c) from t
-- !query schema
struct<extract(dayofweek FROM c):int>
-- !query output
6


-- !query
select extract('dow', c) from t
-- !query schema
struct<extract(dow FROM c):int>
-- !query output
6


-- !query
select extract('doy', c) from t
-- !query schema
struct<extract(doy FROM c):int>
-- !query output
126


-- !query
select extract('hour', c) from t
-- !query schema
struct<extract(hour FROM c):int>
-- !query output
7


-- !query
select extract('minute', c) from t
-- !query schema
struct<extract(minute FROM c):int>
-- !query output
8


-- !query
select extract('second', c) from t
-- !query schema
struct<extract(second FROM c):decimal(8,6)>
-- !query output
9.123456


-- !query
select c - i from t
-- !query schema
struct<CAST(c - i AS STRING):string>
-- !query output
1999-08-05 14:18:02.334456


-- !query
select year(c - i) from t
-- !query schema
struct<year(CAST(CAST(c - i AS STRING) AS DATE)):int>
-- !query output
1999


-- !query
select extract(year from c - i) from t
-- !query schema
struct<extract(year FROM CAST(c - i AS STRING)):int>
-- !query output
1999


-- !query
select extract(month from to_timestamp(c) - i) from t
-- !query schema
struct<extract(month FROM CAST(to_timestamp(c) - i AS TIMESTAMP)):int>
-- !query output
8
