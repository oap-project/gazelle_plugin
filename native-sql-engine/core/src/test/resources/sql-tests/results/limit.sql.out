-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 14


-- !query
SELECT * FROM testdata LIMIT 2
-- !query schema
struct<key:int,value:string>
-- !query output
1	1
2	2


-- !query
SELECT * FROM arraydata LIMIT 2
-- !query schema
struct<arraycol:array<int>,nestedarraycol:array<array<int>>>
-- !query output
[1,2,3]	[[1,2,3]]
[2,3,4]	[[2,3,4]]


-- !query
SELECT * FROM mapdata LIMIT 2
-- !query schema
struct<mapcol:map<int,string>>
-- !query output
{1:"a1",2:"b1",3:"c1",4:"d1",5:"e1"}
{1:"a2",2:"b2",3:"c2",4:"d2"}


-- !query
SELECT * FROM testdata LIMIT 2 + 1
-- !query schema
struct<key:int,value:string>
-- !query output
1	1
2	2
3	3


-- !query
SELECT * FROM testdata LIMIT CAST(1 AS int)
-- !query schema
struct<key:int,value:string>
-- !query output
1	1


-- !query
SELECT * FROM testdata LIMIT -1
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
The limit expression must be equal to or greater than 0, but got -1


-- !query
SELECT * FROM testData TABLESAMPLE (-1 ROWS)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
The limit expression must be equal to or greater than 0, but got -1


-- !query
SELECT * FROM testdata LIMIT CAST(1 AS INT)
-- !query schema
struct<key:int,value:string>
-- !query output
1	1


-- !query
SELECT * FROM testdata LIMIT CAST(NULL AS INT)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
The evaluated limit expression must not be null, but got CAST(NULL AS INT)


-- !query
SELECT * FROM testdata LIMIT key > 3
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
The limit expression must evaluate to a constant value, but got (spark_catalog.default.testdata.`key` > 3)


-- !query
SELECT * FROM testdata LIMIT true
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
The limit expression must be integer type, but got boolean


-- !query
SELECT * FROM testdata LIMIT 'a'
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
The limit expression must be integer type, but got string


-- !query
SELECT * FROM (SELECT * FROM range(10) LIMIT 5) WHERE id > 3
-- !query schema
struct<id:bigint>
-- !query output
4


-- !query
SELECT * FROM testdata WHERE key < 3 LIMIT ALL
-- !query schema
struct<key:int,value:string>
-- !query output
1	1
2	2
