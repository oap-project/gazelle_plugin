-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 7


-- !query
SELECT '' AS two, unique1, unique2, stringu1
		FROM onek WHERE unique1 > 50
		ORDER BY unique1 LIMIT 2
-- !query schema
struct<two:string,unique1:int,unique2:int,stringu1:string>
-- !query output
	51	76	ZBAAAA
	52	985	ACAAAA


-- !query
SELECT '' AS five, unique1, unique2, stringu1
		FROM onek WHERE unique1 > 60
		ORDER BY unique1 LIMIT 5
-- !query schema
struct<five:string,unique1:int,unique2:int,stringu1:string>
-- !query output
	61	560	JCAAAA
	62	633	KCAAAA
	63	296	LCAAAA
	64	479	MCAAAA
	65	64	NCAAAA


-- !query
SELECT '' AS two, unique1, unique2, stringu1
		FROM onek WHERE unique1 > 60 AND unique1 < 63
		ORDER BY unique1 LIMIT 5
-- !query schema
struct<two:string,unique1:int,unique2:int,stringu1:string>
-- !query output
	61	560	JCAAAA
	62	633	KCAAAA


-- !query
CREATE OR REPLACE TEMPORARY VIEW INT8_TBL AS SELECT * FROM
  (VALUES
    (123, 456),
    (123, 4567890123456789),
    (4567890123456789, 123),
    (4567890123456789, 4567890123456789),
    (4567890123456789, -4567890123456789))
  AS v(q1, q2)
-- !query schema
struct<>
-- !query output



-- !query
select * from int8_tbl limit (case when random() < 0.5 then bigint(null) end)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
The limit expression must evaluate to a constant value, but got CASE WHEN (`_nondeterministic` < CAST(0.5BD AS DOUBLE)) THEN CAST(NULL AS BIGINT) END


-- !query
DROP VIEW INT8_TBL
-- !query schema
struct<>
-- !query output



-- !query
select sum(tenthous) as s1, sum(tenthous) + random()*0 as s2
  from tenk1 group by thousand order by thousand limit 3
-- !query schema
struct<s1:bigint,s2:double>
-- !query output
45000	45000.0
45010	45010.0
45020	45020.0
